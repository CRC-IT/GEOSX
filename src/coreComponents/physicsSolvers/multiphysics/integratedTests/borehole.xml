<Problem>
  <!--Tables-->
  <Functions>
    <TableFunction
    name="timeFunction"
    inputVarNames="{time}"
    coordinates="{0.0, 0.1, 1e6}"
    values="{0.0, 1.0, 1.0}"
    />
  </Functions>

  <!--Mesh/Geometry-->
  <Mesh>
    <PAMELAMeshGenerator
    name="mesh1"
    file="borehole_geometry.msh"
    />
  </Mesh>

  <!--It is not required to define all nodeset for external mesh-->
  <Geometry>
    <Box
    name="all"
    xMin="-0.00001, -0.00001, -0.00001"
    xMax=" 4.00001,  4.00001,  1.00001"
    />

    <Box
    name="xneg"
    xMin="-0.00001, -0.00001, -0.00001"
    xMax=" 0.00001,  4.00001,  1.00001"
    />
    <Box
    name="xpos"
    xMin="3.99999, -0.00001, -0.00001"
    xMax=" 4.00001,  4.00001,  1.00001"
    />
    <Box
    name="yneg"
    xMin="-0.00001, -0.00001, -0.00001"
    xMax=" 4.00001,  0.00001,  1.00001"
    />
    <Box
    name="ypos"
    xMin="-0.00001, 3.99999, -0.00001"
    xMax=" 4.00001, 4.00001,  1.00001"
    />
    <Box
    name="zneg"
    xMin="-0.00001, -0.00001, -0.00001"
    xMax=" 4.00001,  4.00001,  0.00001"
    />
    <Box
    name="zpos"
    xMin="-0.00001, -0.00001, 0.99999"
    xMax=" 4.00001,  4.00001, 1.00001"
    />

    <Box
    name="innerBoundary1"
    xMin="0.098, -0.001, -0.001"
    xMax="0.101, 0.014, 1.001"
    />
    <Box
    name="innerBoundary2"
    xMin="0.096, 0.012, -0.001"
    xMax="0.1, 0.027, 1.001"
    />
    <Box
    name="innerBoundary3"
    xMin="0.091, 0.025, -0.001"
    xMax="0.098, 0.039, 1.001"
    />
    <Box
    name="innerBoundary4"
    xMin="0.086, 0.037, -0.001"
    xMax="0.093, 0.051, 1.001"
    />
    <Box
    name="innerBoundary5"
    xMin="0.078, 0.049, -0.001"
    xMax="0.088, 0.062, 1.001"
    />
    <Box
    name="innerBoundary6"
    xMin="0.07, 0.06, -0.001"
    xMax="0.08, 0.072, 1.001"
    />
    <Box
    name="innerBoundary7"
    xMin="0.06, 0.07, -0.001"
    xMax="0.072, 0.08, 1.001"
    />
    <Box
    name="innerBoundary8"
    xMin="0.049, 0.078, -0.001"
    xMax="0.062, 0.088, 1.001"
    />
    <Box
    name="innerBoundary9"
    xMin="0.037, 0.086, -0.001"
    xMax="0.051, 0.093, 1.001"
    />
    <Box
    name="innerBoundary10"
    xMin="0.025, 0.091, -0.001"
    xMax="0.039, 0.098, 1.001"
    />
    <Box
    name="innerBoundary11"
    xMin="0.012, 0.096, -0.001"
    xMax="0.027, 0.1, 1.001"
    />
    <Box
    name="innerBoundary12"
    xMin="-0.001, 0.098, -0.001"
    xMax="0.014, 0.101, 1.001"
    />
    <Box
    name="innerLayer1"
    xMin="0.098144, -0.001, -0.001"
    xMax="0.109333, 0.01514, 1.001"
    />
    <Box
    name="innerLayer2"
    xMin="0.095593, 0.012053000000000001, -0.001"
    xMax="0.108407, 0.029039000000000002, 1.001"
    />
    <Box
    name="innerLayer3"
    xMin="0.091388, 0.024881999999999998, -0.001"
    xMax="0.105642, 0.042457, 1.001"
    />
    <Box
    name="innerLayer4"
    xMin="0.085603, 0.037268, -0.001"
    xMax="0.101087, 0.055167, 1.001"
    />
    <Box
    name="innerLayer5"
    xMin="0.078335, 0.049, -0.001"
    xMax="0.094819, 0.066949, 1.001"
    />
    <Box
    name="innerLayer6"
    xMin="0.069711, 0.059876, -0.001"
    xMax="0.086947, 0.077603, 1.001"
    />
    <Box
    name="innerLayer7"
    xMin="0.059876, 0.069711, -0.001"
    xMax="0.077603, 0.086947, 1.001"
    />
    <Box
    name="innerLayer8"
    xMin="0.049, 0.078335, -0.001"
    xMax="0.066949, 0.094819, 1.001"
    />
    <Box
    name="innerLayer9"
    xMin="0.037268, 0.085603, -0.001"
    xMax="0.055167, 0.101087, 1.001"
    />
    <Box
    name="innerLayer10"
    xMin="0.024881999999999998, 0.091388, -0.001"
    xMax="0.042457, 0.105642, 1.001"
    />
    <Box
    name="innerLayer11"
    xMin="0.012053000000000001, 0.095593, -0.001"
    xMax="0.029039000000000002, 0.108407, 1.001"
    />
    <Box
    name="innerLayer12"
    xMin="-0.001, 0.098144, -0.001"
    xMax="0.01514, 0.109333, 1.001"
    />
  </Geometry>

  <!--Rock properties-->
  <Constitutive>
    <PoroLinearElasticIsotropic
    name="rock"
    defaultDensity="0"
    defaultBulkModulus="3.33333e9"
    defaultShearModulus="5.0e9"
    BiotCoefficient="1.0"
    />
    <CompressibleSinglePhaseFluid
    name="water"
    defaultDensity="1000"
    defaultViscosity="0.001"
    referencePressure="0e6"
    referenceDensity="1000"
    compressibility="1e-19"
    referenceViscosity="0.001"
    viscosibility="0.0"
    />
  </Constitutive>

  <!--Assign rock/fluid properties-->
  <ElementRegions>
    <CellElementRegion
    name="Omega"
    cellBlocks="{0_HEX}"
    materialList="{rock, water}"
    />
  </ElementRegions>

  <!--Boundary conditions-->
  <FieldSpecifications>
    <FieldSpecification
    name="permx"
    component="0"
    initialCondition="1"
    setNames="{all}"
    objectPath="ElementRegions/Omega/0_HEX"
    fieldName="permeability"
    scale="4.45e-16"
    />

    <FieldSpecification
    name="permy"
    component="1"
    initialCondition="1"
    setNames="{all}"
    objectPath="ElementRegions/Omega/0_HEX"
    fieldName="permeability"
    scale="4.45e-16"
    />

    <FieldSpecification
    name="permz"
    component="2"
    initialCondition="1"
    setNames="{all}"
    objectPath="ElementRegions/Omega/0_HEX"
    fieldName="permeability"
    scale="4.45e-16"
    />

    <FieldSpecification
    name="referencePorosity"
    initialCondition="1"
    setNames="{all}"
    objectPath="ElementRegions/Omega/0_HEX"
    fieldName="referencePorosity"
    scale="0.3"
    />

    <FieldSpecification
    name="initialPressure"
    initialCondition="1"
    setNames="{all}"
    objectPath="ElementRegions/Omega/0_HEX"
    fieldName="pressure"
    scale="0e6"
    />

    <FieldSpecification
    name="xconstraint"
    objectPath="nodeManager"
    fieldName="TotalDisplacement"
    component="0"
    scale="0.0"
    setNames="{xneg, xpos}"
    />

    <FieldSpecification
    name="yconstraint"
    objectPath="nodeManager"
    fieldName="TotalDisplacement"
    component="1"
    scale="0.0"
    setNames="{yneg, ypos}"
    />

    <FieldSpecification
    name="zconstraint"
    objectPath="nodeManager"
    fieldName="TotalDisplacement"
    component="2"
    scale="0.0"
    setNames="{zneg, zpos}"
    />

    <!--FieldSpecification
    name="xposPressure"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="10.0e6"
    functionName="timeFunction"
    setNames="{xpos}"
    /-->

    <!--FieldSpecification
    name="yposPressure"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="10.0e6"
    functionName="timeFunction"
    setNames="{ypos}"
    /-->

    <FieldSpecification
    name="farPressure"
    objectPath="ElementRegions/Omega/0_HEX"
    fieldName="pressure"
    scale="0e6"
    setNames="{xpos, ypos}"
    />
    <!--Borehole pressure-->
    <FieldSpecification
    name="boundaryPressure"
    objectPath="ElementRegions/Omega/0_HEX"
    fieldName="pressure"
    scale="10e6"
    setNames="{innerLayer1,innerLayer2,innerLayer3,innerLayer4,innerLayer5,innerLayer6,innerLayer7,innerLayer8,innerLayer9,innerLayer10,innerLayer11,innerLayer12}"

    />


    <!--FieldSpecification
    name="iPx1"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="9978589.232"
    functionName="timeFunction"
    setNames="{innerBoundary1}"
    />
    <FieldSpecification
    name="iPy1"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="654031.292"
    functionName="timeFunction"
    setNames="{innerBoundary1}"
    /-->
    <!--FieldSpecification
    name="iPx2"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="9807852.804"
    functionName="timeFunction"
    setNames="{innerBoundary2}"
    />
    <FieldSpecification
    name="iPy2"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="1950903.22"
    functionName="timeFunction"
    setNames="{innerBoundary2}"
    /-->
    <!--FieldSpecification
    name="iPx3"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="9469301.295"
    functionName="timeFunction"
    setNames="{innerBoundary3}"
    />
    <FieldSpecification
    name="iPy3"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="3214394.653"
    functionName="timeFunction"
    setNames="{innerBoundary3}"
    /-->
    <!--FieldSpecification
    name="iPx4"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="8968727.415"
    functionName="timeFunction"
    setNames="{innerBoundary4}"
    />
    <FieldSpecification
    name="iPy4"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="4422886.902"
    functionName="timeFunction"
    setNames="{innerBoundary4}"
    /-->
    <!--FieldSpecification
    name="iPx5"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="8314696.123"
    functionName="timeFunction"
    setNames="{innerBoundary5}"
    />
    <FieldSpecification
    name="iPy5"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="5555702.33"
    functionName="timeFunction"
    setNames="{innerBoundary5}"
    /-->
    <!--FieldSpecification
    name="iPx6"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="7518398.075"
    functionName="timeFunction"
    setNames="{innerBoundary6}"
    />
    <FieldSpecification
    name="iPy6"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="6593458.151"
    functionName="timeFunction"
    setNames="{innerBoundary6}"
    /-->
    <!--FieldSpecification
    name="iPx7"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="6593458.151"
    functionName="timeFunction"
    setNames="{innerBoundary7}"
    />
    <FieldSpecification
    name="iPy7"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="7518398.075"
    functionName="timeFunction"
    setNames="{innerBoundary7}"
    /-->
    <!--FieldSpecification
    name="iPx8"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="5555702.33"
    functionName="timeFunction"
    setNames="{innerBoundary8}"
    />
    <FieldSpecification
    name="iPy8"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="8314696.123"
    functionName="timeFunction"
    setNames="{innerBoundary8}"
    /-->
    <!--FieldSpecification
    name="iPx9"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="4422886.902"
    functionName="timeFunction"
    setNames="{innerBoundary9}"
    />
    <FieldSpecification
    name="iPy9"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="8968727.415"
    functionName="timeFunction"
    setNames="{innerBoundary9}"
    /-->
    <!--FieldSpecification
    name="iPx10"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="3214394.653"
    functionName="timeFunction"
    setNames="{innerBoundary10}"
    />
    <FieldSpecification
    name="iPy10"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="9469301.295"
    functionName="timeFunction"
    setNames="{innerBoundary10}"
    /-->
    <!--FieldSpecification
    name="iPx11"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="1950903.22"
    functionName="timeFunction"
    setNames="{innerBoundary11}"
    />
    <FieldSpecification
    name="iPy11"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="9807852.804"
    functionName="timeFunction"
    setNames="{innerBoundary11}"
    /-->
    <!--FieldSpecification
    name="iPx12"
    objectPath="faceManager"
    fieldName="Traction"
    component="0"
    scale="654031.292"
    functionName="timeFunction"
    setNames="{innerBoundary12}"
    />
    <FieldSpecification
    name="iPy12"
    objectPath="faceManager"
    fieldName="Traction"
    component="1"
    scale="9978589.232"
    functionName="timeFunction"
    setNames="{innerBoundary12}"
    /-->
  </FieldSpecifications>

  <!--Output-->
  <Outputs>
    <Silo name="siloOutput"/>
    <Restart name="restartOutput"/>
  </Outputs>

  <!-- <Partition>
  <SpatialPartition xPar="1"
  yPar="1"
  zPar="1"/>
  </Partition> -->

  <!--Solvers-->
  <Solvers gravityVector="0.0, 0.0, 0.0">
    <Poroelastic
      name="poroSolve"
      solidSolverName="lagsolve"
      fluidSolverName="SinglePhaseFlow"
      couplingTypeOption="SIM_FixedStress"
      logLevel="1"
      discretization="FE1"
      targetRegions="{Omega}">

      <LinearSolverParameters
      logLevel="0"
      />
      <NonlinearSolverParameters
      newtonMaxIter = "40"
      />
    </Poroelastic>

    <SolidMechanicsLagrangianSSLE
      name="lagsolve"
      timeIntegrationOption="QuasiStatic"
      logLevel="1"
      discretization="FE1"
      targetRegions="{Omega}"
      solidMaterialNames="{rock}">

      <LinearSolverParameters
      solverType="gmres"
      krylovTol="1.0e-10"
      logLevel="0"/>
      <NonlinearSolverParameters
      newtonTol = "1.0e-6"
      newtonMaxIter = "5"
      />
    </SolidMechanicsLagrangianSSLE>

    <SinglePhaseFVM
      name="SinglePhaseFlow"
      logLevel="1"
      discretization="singlePhaseTPFA"
      targetRegions="{Omega}"
      fluidNames="{water}"
      solidNames="{rock}">

      <LinearSolverParameters
      solverType="gmres"
      krylovTol="1.0e-10"
      logLevel="0"/>
      <NonlinearSolverParameters
      newtonTol = "1.0e-6"
      newtonMaxIter = "8"
      />
    </SinglePhaseFVM>
  </Solvers>

  <!--Solver application-->
  <Events maxTime="1">
    <PeriodicEvent
    name="outputs"
    timeFrequency=".25"
    target="/Outputs/siloOutput"
    />

    <PeriodicEvent
    name="solverApplication0"
    beginTime="0"
    endTime="10"
    target="/Solvers/poroSolve"
    />

    <PeriodicEvent
      name="restarts"
      timeFrequency="1e99"
      targetExactTimestep="0"
      target="/Outputs/restartOutput"
    />

  </Events>

  <NumericalMethods>
    <BasisFunctions>
      <LagrangeBasis3 name="linearBasis" degree="1"/>
    </BasisFunctions>
    <QuadratureRules>
      <GaussQuadrature3 name="gaussian" degree="2"/>
    </QuadratureRules>
    <FiniteElements>
      <FiniteElementSpace
      name="FE1"
      parentSpace="C3D8"
      basis="linearBasis"
      quadrature="gaussian"
      />
    </FiniteElements>
    <FiniteVolume>
      <TwoPointFluxApproximation
      name="singlePhaseTPFA"
      fieldName="pressure"
      coefficientName="permeability"
      />
    </FiniteVolume>
  </NumericalMethods>
</Problem>
